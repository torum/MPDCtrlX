<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" 
			 d:DesignWidth="800" d:DesignHeight="450"
			 xmlns:vm="clr-namespace:MPDCtrlX.ViewModels"
			 xmlns:mod="clr-namespace:MPDCtrlX.Models"
             x:Class="MPDCtrlX.Views.SearchPage"
			 x:DataType="vm:MainViewModel"
			 xmlns:prop="clr-namespace:MPDCtrlX.Properties"
			 xmlns:ia="using:Xaml.Behaviors.Interactions.Animated"
             x:CompileBindings="True"
			 Loaded="UserControl_Loaded">
	
	<Grid RowDefinitions="1,Auto,*" SizeChanged="PageGrid_SizeChanged">
		<Border Grid.Row="0" BorderThickness="0,0,0,0" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" Opacity="0.6"></Border>
		
		<Border Grid.Row="1" Background="{DynamicResource NavigationViewDefaultPaneBackground}" Opacity="0.4"></Border>
		<!-- Search page title and menus -->
		<Grid Grid.Row="1" Margin="0,0,0,12">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"></ColumnDefinition>
				<ColumnDefinition Width="Auto"></ColumnDefinition>
				<ColumnDefinition Width="*"></ColumnDefinition>
			</Grid.ColumnDefinitions>

			<!-- Size changes from codebehind depending on page size -->
			<Grid Grid.Column="0" x:Name="HeaderGridSpacer" Width="24"></Grid>
			
			<StackPanel Grid.Row="0" Grid.Column="1" Height="48" Spacing="24" Margin="0" Orientation="Horizontal" HorizontalAlignment="Left">
				<!-- page title-->
				<TextBlock Text="{x:Static prop:Resources.MenuTreeItem_Search}" Theme="{StaticResource TitleTextBlockStyle}" VerticalAlignment="Bottom" Margin="0,0,0,0"/>
				<!-- song count -->
				<TextBlock Theme="{StaticResource CaptionTextBlockStyle}" Text="{Binding SearchPageSubTitleResultCount, Mode=OneWay}" VerticalAlignment="Bottom" Padding="0,0,0,4" Opacity="0.7"/>
			</StackPanel>

			<!-- Page command menu buttons (more) -->
			<StackPanel Grid.Row="0" Grid.Column="2" Height="48" Spacing="6" Margin="0,0,12,0" Orientation="Horizontal" HorizontalAlignment="Right">

				<!-- Play button -->
				<SplitButton VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0" Height="34" ToolTip.Tip="{x:Static prop:Resources.PageMenu_PlayAll}" Command="{Binding SongsPlayCommand}" CommandParameter="{Binding SearchResult}">
					<Viewbox Width="14" Height="14" HorizontalAlignment="Center" VerticalAlignment="Bottom">
						<PathIcon Background="Transparent" Width="NaN" Height="NaN"
							Data="M5.74514 3.06445C5.41183 2.87696 5 3.11781 5 3.50023V12.5005C5 12.8829 5.41182 13.1238 5.74512 12.9363L13.7454 8.43631C14.0852 8.24517 14.0852 7.75589 13.7454 7.56474L5.74514 3.06445ZM4 3.50023C4 2.35298 5.2355 1.63041 6.23541 2.19288L14.2357 6.69317C15.2551 7.26664 15.2551 8.73446 14.2356 9.3079L6.23537 13.8079C5.23546 14.3703 4 13.6477 4 12.5005V3.50023Z">
						</PathIcon>
					</Viewbox>
					<SplitButton.Flyout>
						<MenuFlyout Placement="Bottom">
							<MenuItem Header="{x:Static prop:Resources.PageMenu_QueueAll}" Command="{Binding SongsAddToQueueCommand}" CommandParameter="{Binding SearchResult}">
								<MenuItem.Icon>
									<PathIcon Data="M8 2C8.27614 2 8.5 2.22386 8.5 2.5V7.5H13.5C13.7761 7.5 14 7.72386 14 8C14 8.27614 13.7761 8.5 13.5 8.5H8.5V13.5C8.5 13.7761 8.27614 14 8 14C7.72386 14 7.5 13.7761 7.5 13.5V8.5H2.5C2.22386 8.5 2 8.27614 2 8C2 7.72386 2.22386 7.5 2.5 7.5H7.5V2.5C7.5 2.22386 7.72386 2 8 2Z" Width="NaN" Height="NaN" Margin="0" Padding="0">
									</PathIcon>
								</MenuItem.Icon>
							</MenuItem>
						</MenuFlyout>
					</SplitButton.Flyout>
				</SplitButton>

				<!-- More options button -->
				<Button Margin="0,0,0,0" Width="34" Height="34" HorizontalAlignment="Left" VerticalAlignment="Bottom" ToolTip.Tip="{x:Static prop:Resources.PageMenu_More}">
					<Viewbox Width="14" Height="14" HorizontalAlignment="Center" VerticalAlignment="Bottom">
						<PathIcon Background="Transparent" Width="NaN" Height="NaN"
							Data="M10 6C9.30964 6 8.75 5.44036 8.75 4.75C8.75 4.05964 9.30964 3.5 10 3.5C10.6904 3.5 11.25 4.05964 11.25 4.75C11.25 5.44036 10.6904 6 10 6ZM10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10C11.25 10.6904 10.6904 11.25 10 11.25ZM8.75 15.25C8.75 15.9404 9.30964 16.5 10 16.5C10.6904 16.5 11.25 15.9404 11.25 15.25C11.25 14.5596 10.6904 14 10 14C9.30964 14 8.75 14.5596 8.75 15.25Z">
						</PathIcon>
					</Viewbox>
					<Button.Flyout>
						<MenuFlyout>
							<!-- Header visibility -->
							<MenuItem Header="{x:Static prop:Resources.FlyoutMenu_ColumnVisibility}" IsVisible="False">
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Title}" IsChecked="True" IsEnabled="False">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Time}" IsChecked="{Binding IsSearchColumnHeaderTimeVisible}" Command="{Binding SearchColumnHeaderTimeShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Artist}" IsChecked="{Binding IsSearchColumnHeaderArtistVisible}" Command="{Binding SearchColumnHeaderArtistShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Album}" IsChecked="{Binding IsSearchColumnHeaderAlbumVisible}" Command="{Binding SearchColumnHeaderAlbumShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Disc}" IsChecked="{Binding IsSearchColumnHeaderDiscVisible}" Command="{Binding SearchColumnHeaderDiscShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Track}" IsChecked="{Binding IsSearchColumnHeaderTrackVisible}" Command="{Binding SearchColumnHeaderTrackShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_Genre}" IsChecked="{Binding IsSearchColumnHeaderGenreVisible}" Command="{Binding SearchColumnHeaderGenreShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
								<MenuItem Header="{x:Static prop:Resources.ListviewColumnHeader_LastModified}" IsChecked="{Binding IsSearchColumnHeaderLastModifiedVisible}" Command="{Binding SearchColumnHeaderLastModifiedShowHideCommand}">
									<MenuItem.Icon>
										<Path Data="M13.8639 3.65511C14.0533 3.85606 14.0439 4.17251 13.8429 4.36191L5.91309 11.8358C5.67573 12.0595 5.30311 12.0526 5.07417 11.8203L2.39384 9.09995C2.20003 8.90325 2.20237 8.58667 2.39907 8.39286C2.59578 8.19905 2.91235 8.2014 3.10616 8.3981L5.51192 10.8398L13.1571 3.63419C13.358 3.44479 13.6745 3.45416 13.8639 3.65511Z"
											IsVisible="{Binding $parent[MenuItem].IsChecked}" Fill="{DynamicResource ComboBoxDropDownGlyphForeground}"/>
									</MenuItem.Icon>
								</MenuItem>
							</MenuItem>
							<Separator IsVisible="False"/>
							<MenuItem Header="{x:Static prop:Resources.FlyoutMenu_AddToPlaylist}" Command="{Binding SearchPageSongsAddToPlaylistCommand}" CommandParameter="{Binding SearchResult}"/>
						</MenuFlyout>
					</Button.Flyout>
				</Button>

			</StackPanel>

			<Grid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Height="48" Margin="12,0,12,0" HorizontalAlignment="Stretch">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"></ColumnDefinition>
					<ColumnDefinition Width="Auto"></ColumnDefinition>
					<ColumnDefinition Width="*"></ColumnDefinition>
					<ColumnDefinition Width="Auto"></ColumnDefinition>
				</Grid.ColumnDefinitions>

				<!-- Search tag combobox -->
				<ComboBox Grid.Column="0" SelectedIndex="0" MinWidth="140" Margin="6,0,0,0" ItemsSource="{Binding SearchTagList,Mode=OneWay}" SelectedItem="{Binding SelectedSearchTag,Mode=TwoWay}" VerticalAlignment="Bottom">
					<ComboBox.ItemTemplate>
						<DataTemplate x:DataType="mod:SearchOption">
							<TextBlock Text="{Binding Label}" VerticalAlignment="Center"/>
						</DataTemplate>
					</ComboBox.ItemTemplate>
				</ComboBox>

				<!-- Search Shiki combobox -->
				<ComboBox Grid.Column="1" SelectedIndex="0" MinWidth="140" Margin="6,0,0,0" ItemsSource="{Binding SearchShikiList,Mode=OneWay}" SelectedItem="{Binding SelectedSearchShiki,Mode=TwoWay}" VerticalAlignment="Bottom">
					<ComboBox.ItemTemplate>
						<DataTemplate x:DataType="mod:SearchWith">
							<TextBlock Text="{Binding Label}" VerticalAlignment="Center"/>
						</DataTemplate>
					</ComboBox.ItemTemplate>
				</ComboBox>

				<!--Search query input textbox -->
				<StackPanel Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Bottom">
					<TextBox x:Name="SearchQueryInputTextBox" MinWidth="100" Text="{Binding SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="6,0,0,0" HorizontalAlignment="Stretch">
						<Interaction.Behaviors>
							<EventTriggerBehavior EventName="Loaded">
								<FocusControlAction />
							</EventTriggerBehavior>
						</Interaction.Behaviors>
					</TextBox>
				</StackPanel>

				<!-- Search button -->
				<Button Grid.Column="3" Command="{Binding SearchExecCommand}" Margin="6,0,0,0" ToolTip.Tip="{x:Static prop:Resources.PageMenu_Search}" HorizontalAlignment="Center" Height="34" Width="34" VerticalAlignment="Bottom">
					<Viewbox Width="14" Height="14">
						<PathIcon Background="Transparent" Width="NaN" Height="NaN" Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></PathIcon>
					</Viewbox>
				</Button>
			</Grid>
		</Grid>

		<!-- Search ListBox -->
		<Grid Grid.Row="2" RowDefinitions="1,Auto,1,*">
			<Border Grid.Row="0" BorderThickness="0,1,0,0" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" Opacity="0.6"></Border>
			<Border Grid.Row="1" Grid.ColumnSpan="3" Background="{DynamicResource NavigationViewDefaultPaneBackground}" Opacity="0.4"></Border>
			<ScrollViewer Grid.Row="1" x:Name="SearchListViewHeaderScrollViewer" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Disabled">
				<!-- This is a workaround to keep the header in sync with the ListBox scrolling. -->
				<Grid Name="DummyHeader" Height="34" Margin="1,0,0,0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="80"></ColumnDefinition>
						<ColumnDefinition Width="0"></ColumnDefinition>
						<ColumnDefinition Width="6*"></ColumnDefinition>
						<ColumnDefinition Width="70"></ColumnDefinition>
						<ColumnDefinition Width="3*"></ColumnDefinition>
						<ColumnDefinition Width="3*"></ColumnDefinition>
						<ColumnDefinition Width="65"></ColumnDefinition>
						<ColumnDefinition Width="65"></ColumnDefinition>
						<ColumnDefinition Width="2*"></ColumnDefinition>
						<ColumnDefinition Width="2*"></ColumnDefinition>

						<ColumnDefinition Width="24"></ColumnDefinition>
						<ColumnDefinition Width="Auto"></ColumnDefinition>
					</Grid.ColumnDefinitions>
					
					<Border Grid.Column="0" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="0" Name="SearchColumn1" Width="80">
						<TextBlock Name="SearchColumn1x" Opacity="1" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center"></TextBlock>
					</Grid>

					<Border Grid.Column="1" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5" IsVisible="False"/>
					<Grid Grid.Column="1" Name="SearchColumn2" IsVisible="False">
					</Grid>

					<Border Grid.Column="2" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="2" Name="SearchColumn3">
						<TextBlock Name="SearchColumn3x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Title}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="3" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="3" Name="SearchColumn4" IsVisible="{Binding IsSearchColumnHeaderTimeVisible}">
						<TextBlock Name="SearchColumn4x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Time}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="4" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="4" Name="SearchColumn5" IsVisible="{Binding IsSearchColumnHeaderArtistVisible}">
						<TextBlock Name="SearchColumn5x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Artist}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="5" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="5" Name="SearchColumn6" IsVisible="{Binding IsSearchColumnHeaderAlbumVisible}">
						<TextBlock Name="SearchColumn6x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Album}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="6" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="6" Name="SearchColumn7" IsVisible="{Binding IsSearchColumnHeaderDiscVisible}">
						<TextBlock Name="SearchColumn7x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Disc}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="7" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="7" Name="SearchColumn8" IsVisible="{Binding IsSearchColumnHeaderTrackVisible}">
						<TextBlock Name="SearchColumn8x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Track}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="8" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="8" Name="SearchColumn9" IsVisible="{Binding IsSearchColumnHeaderGenreVisible}">
						<TextBlock Name="SearchColumn9x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_Genre}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="9" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5"/>
					<Grid Grid.Column="9" Name="SearchColumn10" IsVisible="{Binding IsSearchColumnHeaderLastModifiedVisible}">
						<TextBlock Name="SearchColumn10x" Opacity="0.5" HorizontalAlignment="Left" Padding="12,0,0,0" VerticalAlignment="Center" Text="{x:Static prop:Resources.ListviewColumnHeader_LastModified}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
					</Grid>

					<Border Grid.Column="10" Background="Transparent" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" BorderThickness="0,0,1,0" Opacity="0.5" IsVisible="False"/>

				</Grid>
			</ScrollViewer>
			<Border Grid.Row="2" BorderThickness="0,0,0,1" BorderBrush="{DynamicResource LayerFillColorDefaultBrush}" Opacity="0.5"></Border>
			<ListBox Grid.Row="3" ItemsSource="{Binding SearchResult}" SelectionMode="Multiple" BorderThickness="0" Margin="0,3,0,4" ScrollViewer.AllowAutoHide="True" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Disabled" Loaded="ListBox_Loaded">
				<!--  Background="{DynamicResource LayerFillColorDefaultBrush}" -->
				<ListBox.Resources>
					<!-- Edit: VerticalScrollViewerAnimatedBehavior. -->
					<!-- This is a workaround to keep the header in sync with the ListBox scrolling. Added ScrollChanged="ScrollViewer_ScrollChanged" -->
					<ControlTheme x:Key="{x:Type ListBox}" TargetType="ListBox">
						<Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}" />
						<Setter Property="Background" Value="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" />
						<Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundBaseHighBrush}" />
						<Setter Property="BorderThickness" Value="{DynamicResource ListBoxBorderThemeThickness}" />
						<Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
						<Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
						<Setter Property="ScrollViewer.IsScrollChainingEnabled" Value="True" />
						<Setter Property="ScrollViewer.IsScrollInertiaEnabled" Value="True" />
						<Setter Property="Template">
							<ControlTemplate>
								<Border Name="border"
										ClipToBounds="{TemplateBinding ClipToBounds}"
										Background="{TemplateBinding Background}"
										BorderBrush="{TemplateBinding BorderBrush}"
										BorderThickness="{TemplateBinding BorderThickness}"
										CornerRadius="{TemplateBinding CornerRadius}">
									<ScrollViewer Name="PART_ScrollViewer"
												  ScrollChanged="ScrollViewer_ScrollChanged"
												  VerticalSnapPointsType="{TemplateBinding (ScrollViewer.VerticalSnapPointsType)}"
												  HorizontalSnapPointsType="{TemplateBinding (ScrollViewer.HorizontalSnapPointsType)}"
												  HorizontalScrollBarVisibility="{TemplateBinding (ScrollViewer.HorizontalScrollBarVisibility)}"
												  VerticalScrollBarVisibility="{TemplateBinding (ScrollViewer.VerticalScrollBarVisibility)}"
												  IsScrollChainingEnabled="{TemplateBinding (ScrollViewer.IsScrollChainingEnabled)}"
												  IsScrollInertiaEnabled="{TemplateBinding (ScrollViewer.IsScrollInertiaEnabled)}"
												  IsDeferredScrollingEnabled="{TemplateBinding (ScrollViewer.IsDeferredScrollingEnabled)}"
												  AllowAutoHide="{TemplateBinding (ScrollViewer.AllowAutoHide)}"
												  BringIntoViewOnFocusChange="{TemplateBinding (ScrollViewer.BringIntoViewOnFocusChange)}">
										<Interaction.Behaviors>
											<ia:VerticalScrollViewerAnimatedBehavior/>
										</Interaction.Behaviors>
										<ItemsPresenter Name="PART_ItemsPresenter"
														ItemsPanel="{TemplateBinding ItemsPanel}"
														Margin="{TemplateBinding Padding}"/>
									</ScrollViewer>
								</Border>
							</ControlTemplate>
						</Setter>
					</ControlTheme>
				</ListBox.Resources>
				<ListBox.ItemsPanel>
					<ItemsPanelTemplate>
						<VirtualizingStackPanel />
					</ItemsPanelTemplate>
				</ListBox.ItemsPanel>
				<ListBox.ItemTemplate>
					<DataTemplate x:DataType="mod:SongInfo">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>

								<ColumnDefinition Width="24"></ColumnDefinition>
								<ColumnDefinition Width="Auto"></ColumnDefinition>
								<!-- Width="{Binding Width, ElementName=test3}" MinWidth="{Binding MinWidth, ElementName=test3}" MaxWidth="{Binding MaxWidth, ElementName=test3}" -->
							</Grid.ColumnDefinitions>
							<!--						
							<TextBlock Grid.Column="0" Width="{Binding Bounds.Size.Width, ElementName=test1}" Text="" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9" IsVisible="False"></TextBlock>
-->
							<StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Center" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn1}">
								<Button Margin="2,0,0,0" Command="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).SongsListviewPlayThisCommand}" CommandParameter="{Binding}" ToolTip.Tip="{x:Static prop:Resources.ListViewItemContextMenu_Play}" Background="Transparent" BorderThickness="0">
									<Viewbox Width="12" Height="12" Margin="0" HorizontalAlignment="Center" VerticalAlignment="Center">
										<PathIcon Data="M5.74514 3.06445C5.41183 2.87696 5 3.11781 5 3.50023V12.5005C5 12.8829 5.41182 13.1238 5.74512 12.9363L13.7454 8.43631C14.0852 8.24517 14.0852 7.75589 13.7454 7.56474L5.74514 3.06445ZM4 3.50023C4 2.35298 5.2355 1.63041 6.23541 2.19288L14.2357 6.69317C15.2551 7.26664 15.2551 8.73446 14.2356 9.3079L6.23537 13.8079C5.23546 14.3703 4 13.6477 4 12.5005V3.50023Z" Width="NaN" Height="NaN" Margin="0" Padding="0">
										</PathIcon>
									</Viewbox>
								</Button>
								<Button Margin="3,0,0,0" Command="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).SongsListviewAddThisCommand}" CommandParameter="{Binding}" ToolTip.Tip="{x:Static prop:Resources.ListviewItemContextMenu_AddToQueue}" Background="Transparent" BorderThickness="0">
									<Viewbox Width="12" Height="12" HorizontalAlignment="Center" VerticalAlignment="Center">
										<PathIcon Data="M8 2C8.27614 2 8.5 2.22386 8.5 2.5V7.5H13.5C13.7761 7.5 14 7.72386 14 8C14 8.27614 13.7761 8.5 13.5 8.5H8.5V13.5C8.5 13.7761 8.27614 14 8 14C7.72386 14 7.5 13.7761 7.5 13.5V8.5H2.5C2.22386 8.5 2 8.27614 2 8C2 7.72386 2.22386 7.5 2.5 7.5H7.5V2.5C7.5 2.22386 7.72386 2 8 2Z" Width="NaN" Height="NaN" Margin="0" Padding="0">
										</PathIcon>
									</Viewbox>
								</Button>
							</StackPanel>
							<Grid Grid.Column="1" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn2}">
								<Viewbox Width="14" Height="14" Margin="0" HorizontalAlignment="Right" VerticalAlignment="Center">
								</Viewbox>
							</Grid>
							<TextBlock Grid.Column="2" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn3}" Text="{Binding Title}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="3" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn4}" Text="{Binding TimeFormated}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderTimeVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="4" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn5}" Text="{Binding Artist}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderArtistVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="5" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn6}" Text="{Binding Album}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderAlbumVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="6" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn7}" Text="{Binding Disc}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderDiscVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="7" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn8}" Text="{Binding Track}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderTrackVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="8" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn9}" Text="{Binding Genre}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderGenreVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>
							<TextBlock Grid.Column="9" Width="{Binding Bounds.Size.Width, ElementName=SearchColumn10}" Text="{Binding LastModifiedFormated}" IsVisible="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).IsSearchColumnHeaderLastModifiedVisible}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0" Padding="12,0,0,0" Opacity="0.9">
							</TextBlock>

						</Grid>
					</DataTemplate>
				</ListBox.ItemTemplate>
				<ListBox.Styles>
					<Style Selector="ListBoxItem" x:DataType="mod:SongInfo">
						<Setter Property="Height" Value="38"/>
						<Setter Property="MinHeight" Value="32"/>
						<Setter Property="Padding" Value="0,0,0,0"/>
						<Setter Property="VerticalAlignment" Value="Center"/>
						<Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
						<Setter Property="ContextFlyout">
							<Setter.Value>
								<MenuFlyout>
									<MenuItem Header="{x:Static prop:Resources.ListViewItemContextMenu_Play}" Command="{Binding Path=$parent[ListBox].((vm:MainViewModel)DataContext).SongsListviewPlayThisCommand}" CommandParameter="{Binding $parent[ListBox].SelectedItem}">
										<MenuItem.Icon>
											<PathIcon Background="Transparent" Width="NaN" Height="NaN"
	Data="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm8.856-3.845A1.25 1.25 0 0 0 9 9.248v5.504a1.25 1.25 0 0 0 1.856 1.093l5.757-3.189a.75.75 0 0 0 0-1.312l-5.757-3.189Z">
											</PathIcon>
										</MenuItem.Icon>
									</MenuItem>
									<MenuItem Header="{x:Static prop:Resources.ListviewItemContextMenu_AddToQueue}" Command="{Binding Path=$parent[ListBox].((vm:MainViewModel)DataContext).SongsListviewAddSelectedToQueueCommand}" CommandParameter="{Binding $parent[ListBox].SelectedItems}">
										<MenuItem.Icon>
											<PathIcon Background="Transparent" Width="NaN" Height="NaN"
	Data="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2Zm0 5a.75.75 0 0 0-.743.648l-.007.102v3.5h-3.5a.75.75 0 0 0-.102 1.493l.102.007h3.5v3.5a.75.75 0 0 0 1.493.102l.007-.102v-3.5h3.5a.75.75 0 0 0 .102-1.493l-.102-.007h-3.5v-3.5A.75.75 0 0 0 12 7Z">
											</PathIcon>
										</MenuItem.Icon>
									</MenuItem>
									<MenuItem Header="{x:Static prop:Resources.ListviewItemContextMenu_AddToPlaylist}" Command="{Binding Path=$parent[ListBox].((vm:MainViewModel)DataContext).SearchListviewSaveSelectedToCommand}" CommandParameter="{Binding $parent[ListBox].SelectedItems}">
										<MenuItem.Icon>
											<PathIcon Background="Transparent" Width="NaN" Height="NaN"
	Data="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2Zm0 5a.75.75 0 0 0-.743.648l-.007.102v3.5h-3.5a.75.75 0 0 0-.102 1.493l.102.007h3.5v3.5a.75.75 0 0 0 1.493.102l.007-.102v-3.5h3.5a.75.75 0 0 0 .102-1.493l-.102-.007h-3.5v-3.5A.75.75 0 0 0 12 7Z">
											</PathIcon>
										</MenuItem.Icon>
									</MenuItem>
								</MenuFlyout>
							</Setter.Value>
						</Setter>
					</Style>
				</ListBox.Styles>

			</ListBox>
		</Grid>
	</Grid>
	
</UserControl>
